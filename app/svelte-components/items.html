<div class="component component-item" data-id="{{ data.id }}">
  <article class="item item-{{ display }} {{ data.inView ? 'in-view' : '' }}" data-id="{{ data.id }}">
    <div class="item-header">
      <div class="item-header-left">
        <h1 class="heading-alternate">
          <a href="{{ data.basePath }}/{{ data.filename }}">{{ data.name }}</a>
        </h1>

        {{#if data.byline && display !== 'list'}}
          <div class="byline">
            {{#if fullByline(data)}}
              {{{ data.byline }}}
            {{else}}
              <strong>By {{ escapeHTML(data.byline) }}</strong> â€¢ Star Tribune
            {{/if}}
          </div>
        {{/if}}

        {{#if data.address}}
          <address>{{ data.address }}</address>
        {{/if}}
      </div>

      <div class="item-header-right">
        <div class="near-me">
          {{#if data.distance && view === 'distance'}}
            {{ utils.round(data.distance, 1) }} mi
          {{else}}
            &nbsp;
          {{/if}}
        </div>

        {{#if data.latitude && data.longitude}}
          <a href="{{ directionsURL(data, store) }}" target="_blank" rel="noopener" class="directions">Directions</a>
        {{/if}}
      </div>
    </div>

    {{#if data.mainImage && data.mainImage[0] && display !== 'map' }}
      <div class="item-image">
        <figure>
          <picture>
            <source
              type="image/webp"
              srcset="{{ srcset(data.basePath, data.mainImageLocal, 'webp') }}"
              sizes="100vw">
            <source
              type="image/jpeg"
              srcset="{{ srcset(data.basePath, data.mainImageLocal) }}"
              sizes="100vw">
            <img
              alt="Main image for '{{ data.name }}'"
              src="{{ data.basePath }}/{{ data.mainImageLocal }}">
          </picture>

          <cite>{{ data.imageCredit}}</cite>
        </figure>
      </div>
    {{/if}}

    <p>{{{ data.description }}}</p>

    {{#if display !== 'map'}}
      {{#if data.phone || data.website || data.startDate}}
        <dl>
          {{#if data.startDate}}
            <dt><span>When</span></dt>
            <dd><span>
              {{ data.startDate }}
              {{ data.endDate && data.startDate !== data.endDate ? ' - ' + data.endDate : '' }}
            </span></dd>
          {{/if}}

          {{#if data.phone}}
            <dt><span>Phone</span></dt>
            <dd><span class="linkable">{{ data.phone }}</span></dd>
          {{/if}}

          {{#if data.website}}
            <dt><span>Website</span></dt>
            <dd><span class="linkable">
              <a href="{{ data.website }}<" target="_blank" rel="noopener">{{ data.website }}</a>
            </span></dd>
          {{/if}}
        </dl>
      {{/if}}

      <div class="social-buttons social-buttons-gray">
        <a href="{{ facebookURL(data, content) }}" target="_blank" rel="noopener" class="facebook-button">
          <span class="sr-only">Share on Facebook</span>
        </a>
        <a href="{{ twitterURL(data, content) }}" target="_blank" rel="noopener" class="twitter-button">
          <span class="sr-only">Share on Twitter</span>
        </a>
        <a href="{{ emailURL(data, content) }}" target="_blank" rel="noopener" class="email-button">
          <span class="sr-only">Share via email</span>
        </a>
      </div>

      {{#if display !== 'list' && data.lists}}
        <div class="related">
          <h3>Related</h3>
          {{#each data.lists as l @id}}
            <a href="{{ data.basePath }}/{{ l.filename }}">{{ l.title }}</a>
          {{/each}}
        </div>
      {{/if}}
    {{/if}}
  </article>
</div>

<script>
import helpers from './common/helpers.js';
import methods from './common/methods.js';

export default {
  helpers: {
    fullByline: helpers.fullByline,
    directionsURL: helpers.directionsURL,
    facebookURL: helpers.facebookURL,
    twitterURL: helpers.twitterURL,
    emailURL: helpers.emailURL,
    escapeHTML: helpers.escapeHTML,
    srcset: helpers.srcset
  },

  data() {
    return {
      display: 'full',
      isBrowser: typeof window !== undefined
    };
  }
};
</script>
